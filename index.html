<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Temperature in Major Cities</title>
    <script src="http://cdn1.zingchart.com/scripts/zingchart/html5_scripts/zingchart-html5-min.js"></script>
    <script src="https://cdn.firebase.com/js/client/2.0.6/firebase.js"></script>
    <script src="https://code.jquery.com/jquery-2.1.1.min.js"></script>
    <script>
    var myChart=
    {
        "graphset":[
        {
            "type":"bar",
            "background-color":"#898d95 #4f4f4f",
            "border-radius-top-left":13,
            "border-radius-top-right":13,
            "border-radius-bottom-right":10,
            "border-radius-bottom-left":10,
            "title":{
                "text":"Temperature in Major Cities",
                "text-align":"center",
                "background-color":"#ffffff",
                "font-family":"Calibri",
                "font-size":"24px",
                "font-color":"#4f4f4f",
                "border-radius-top-left":10,
                "border-radius-top-right":10
            },
            "plot":{
                "border-radius-top-left":10,
                "border-radius-top-right":10,
                "value-box":{
                    "visible":true,
                    "font-color":"#F4F7F7",
                    "placement":"in",
                    "offset-y":"20px",
                    "font-weight":"bold",
                    "text":"%v°"
                },
                "animation":{
                 "effect":"4",
                 "speed":"1",
                 "method":"ANIMATION_BOUNCE_EASE_OUT"
                },
                "tooltip" : {
                        "text" : "%kl: %v°",
                        "background-color" : "#C98E93",
                }              
        },
        "plotarea":{
            "background-color":"#6c6e72",
            "margin":"80px 60px 60px 80px"
        },
        "scale-x":{
            "label":{
                "text":"CITIES",
                "font-color":"#fff",
            },
            "values":[
            "Austin",
            "Boston",
            "Chicago",  
            "Denver",
            "Detroit",
            "Houston",
            "Las Vegas",
            "Los Angeles",
            "New York",
            "Oklahoma City",
            "Phoenix",
            "Portland",
            "San Diego",
            "San Francisco",
            "Seattle",
            "Washington"
            ],
            "item":{
                "font-color":"#fff"
            },
            "line-color":"#fff",
            "line-width":"1px",
            "tick":{
                "visible":false
            },
            "guide":{
                "line-width":"1px",
                "line-color":"#fff",
                "line-style":"solid",
                "alpha":0.2
            }
        },
        "scale-y":{
            "label":{
                "text":"TEMPERATURE",
                "font-color":"#fff",
                "offset-x":"-10px"
            },
            "multiplier":true,
            "item":{
                "font-color":"#fff"
            },
            "line-color":"#fff",
            "line-width":"1px",
            "tick":{
                "visible":false
            },
            "guide":{
                "line-width":"1px",
                "line-color":"#fff",
                "line-style":"solid",
                "alpha":0.2
            }
        },
        "series":[
        {
            "values":[],
            "text":"Temperature",
            "background-color-1":"#ADD8C7",
            "background-color-2":"#C4EDE4",
            "background-fit":"x"
        }
        ]
    }
    ]
};
window.onload=function(){
    zingchart.render({
        id:"myChartDiv",
        data:myChart,
        height:700,
        width:"100%"
    });
};

$(document).ready(function () {
    var f, ref = new Firebase('https://publicdata-weather.firebaseio.com');
    ref.on("value", function updateWeather(f) {   

      $("#selector").change();

      var temperatures = []
      
      for (var cityId in cities) {
          var cityData = cities[cityId];
          var cityVal = cityData.toLowerCase().replace(' ', '');
          f = ref.child(cityVal).child("currently");
          f.once("value", function (s) {
              var data = s.val();
              var temp = data.apparentTemperature;
              temperatures.push(temp);
          });
      }
      
      zingchart.exec('myChartDiv', 'setseriesvalues', {
        graphid : 0,
        plotindex : 0,
        values:temperatures
    });         
  });
});

var cities = [
"Austin",
"Boston",
"Chicago",  
"Denver",
"Detroit",
"Houston",
"Las Vegas",
"Los Angeles",
"New York",
"Oklahoma City",
"Phoenix",
"Portland",
"San Diego",
"San Francisco",
"Seattle",
"Washington"
];


</script>
</head>
<body> 
    <div id="myChartDiv"></div>
    <div id="output"></div>
</body>
</html>